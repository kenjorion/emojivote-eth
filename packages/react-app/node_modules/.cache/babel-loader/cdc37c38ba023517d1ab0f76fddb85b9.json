{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ken/Documents/scaffold-eth/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/Users/ken/Documents/scaffold-eth/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/Users/ken/Documents/scaffold-eth/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/ken/Documents/scaffold-eth/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect}from'react';import{ethers}from\"ethers\";import{usePoller}from\".\";var DEBUG=false;export default function useCustomContractReader(contract,functionName,args,pollTime,formatter,onChange){var _this=this;var adjustPollTime=3777;if(pollTime){adjustPollTime=pollTime;}else if(!pollTime&&typeof args==\"number\"){//it's okay to pass poll time as last argument without args for the call\nadjustPollTime=args;}var _useState=useState(),_useState2=_slicedToArray(_useState,2),value=_useState2[0],setValue=_useState2[1];useEffect(function(){if(typeof onChange==\"function\"){setTimeout(onChange.bind(_this,value),1);}},[value]);usePoller(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var newValue;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(contract&&typeof contract[functionName]!=\"undefined\")){_context.next=20;break;}_context.prev=1;if(DEBUG)console.log(\"CALLING CUSTOM CONTRACT\",functionName,\"with args\",args);if(!(args&&args.length>0)){_context.next=10;break;}_context.next=6;return contract[functionName].apply(contract,_toConsumableArray(args));case 6:newValue=_context.sent;if(DEBUG)console.log(\"custom contract functionName\",functionName,\"args\",args,\"RESULT:\",newValue);_context.next=13;break;case 10:_context.next=12;return contract[functionName]();case 12:newValue=_context.sent;case 13:if(formatter&&typeof formatter==\"function\"){newValue=formatter(newValue);}//console.log(\"GOT VALUE\",newValue)\nif(newValue!=value){setValue(newValue);}_context.next=20;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](1);console.log(_context.t0);case 20:case\"end\":return _context.stop();}}},_callee,null,[[1,17]]);})),adjustPollTime);return value;}","map":{"version":3,"sources":["/Users/ken/Documents/scaffold-eth/packages/react-app/src/hooks/CustomContractReader.js"],"names":["useState","useEffect","ethers","usePoller","DEBUG","useCustomContractReader","contract","functionName","args","pollTime","formatter","onChange","adjustPollTime","value","setValue","setTimeout","bind","console","log","length","newValue"],"mappings":"qmBAAA,OAASA,QAAT,CAAmBC,SAAnB,KAAoC,OAApC,CACA,OAASC,MAAT,KAAuB,QAAvB,CACA,OAASC,SAAT,KAA0B,GAA1B,CAEA,GAAMC,CAAAA,KAAK,CAAG,KAAd,CAEA,cAAe,SAASC,CAAAA,uBAAT,CAAiCC,QAAjC,CAA0CC,YAA1C,CAAuDC,IAAvD,CAA4DC,QAA5D,CAAqEC,SAArE,CAA+EC,QAA/E,CAAyF,gBAEtG,GAAIC,CAAAA,cAAc,CAAG,IAArB,CACA,GAAGH,QAAH,CAAY,CACVG,cAAc,CAAGH,QAAjB,CACD,CAFD,IAEO,IAAG,CAACA,QAAD,EAAa,MAAOD,CAAAA,IAAP,EAAe,QAA/B,CAAwC,CAC7C;AACAI,cAAc,CAAGJ,IAAjB,CACD,CARqG,cAU5ER,QAAQ,EAVoE,wCAU/Fa,KAV+F,eAUxFC,QAVwF,eAWtGb,SAAS,CAAC,UAAM,CACd,GAAG,MAAOU,CAAAA,QAAP,EAAmB,UAAtB,CAAiC,CAC/BI,UAAU,CAACJ,QAAQ,CAACK,IAAT,CAAc,KAAd,CAAmBH,KAAnB,CAAD,CAA2B,CAA3B,CAAV,CACD,CACF,CAJQ,CAIN,CAACA,KAAD,CAJM,CAAT,CAMAV,SAAS,sEAAC,qJACLG,QAAQ,EAAI,MAAOA,CAAAA,QAAQ,CAACC,YAAD,CAAf,EAAiC,WADxC,2CAIJ,GAAGH,KAAH,CAAUa,OAAO,CAACC,GAAR,CAAY,yBAAZ,CAAsCX,YAAtC,CAAoD,WAApD,CAAiEC,IAAjE,EAJN,KAKDA,IAAI,EAAEA,IAAI,CAACW,MAAL,CAAc,CALnB,iDAMeb,CAAAA,QAAQ,CAACC,YAAD,CAAR,OAAAD,QAAQ,oBAAkBE,IAAlB,EANvB,QAMFY,QANE,eAOF,GAAGhB,KAAH,CAAUa,OAAO,CAACC,GAAR,CAAY,8BAAZ,CAA2CX,YAA3C,CAAwD,MAAxD,CAA+DC,IAA/D,CAAoE,SAApE,CAA8EY,QAA9E,EAPR,sDASed,CAAAA,QAAQ,CAACC,YAAD,CAAR,EATf,SASFa,QATE,uBAWJ,GAAGV,SAAS,EAAI,MAAOA,CAAAA,SAAP,EAAoB,UAApC,CAA+C,CAC7CU,QAAQ,CAAGV,SAAS,CAACU,QAAD,CAApB,CACD,CACD;AACA,GAAGA,QAAQ,EAAEP,KAAb,CAAmB,CACjBC,QAAQ,CAACM,QAAD,CAAR,CACD,CAjBG,iFAmBJH,OAAO,CAACC,GAAR,cAnBI,qEAAD,GAsBPN,cAtBO,CAAT,CAwBA,MAAOC,CAAAA,KAAP,CACD","sourcesContent":["import { useState, useEffect } from 'react';\nimport { ethers } from \"ethers\";\nimport { usePoller } from \".\";\n\nconst DEBUG = false\n\nexport default function useCustomContractReader(contract,functionName,args,pollTime,formatter,onChange) {\n\n  let adjustPollTime = 3777\n  if(pollTime){\n    adjustPollTime = pollTime\n  } else if(!pollTime && typeof args == \"number\"){\n    //it's okay to pass poll time as last argument without args for the call\n    adjustPollTime = args\n  }\n\n  const [value, setValue] = useState()\n  useEffect(() => {\n    if(typeof onChange == \"function\"){\n      setTimeout(onChange.bind(this,value),1)\n    }\n  }, [value]);\n\n  usePoller(async ()=>{\n    if(contract && typeof contract[functionName] != \"undefined\"){\n      try{\n        let newValue\n        if(DEBUG) console.log(\"CALLING CUSTOM CONTRACT\",functionName, \"with args\", args)\n        if(args&&args.length > 0){\n          newValue = await contract[functionName](...args)\n          if(DEBUG) console.log(\"custom contract functionName\",functionName,\"args\",args,\"RESULT:\",newValue)\n        }else{\n          newValue = await contract[functionName]()\n        }\n        if(formatter && typeof formatter == \"function\"){\n          newValue = formatter(newValue)\n        }\n        //console.log(\"GOT VALUE\",newValue)\n        if(newValue!=value){\n          setValue(newValue)\n        }\n      }catch(e){\n        console.log(e)\n      }\n    }\n  },adjustPollTime)\n\n  return value;\n}\n"]},"metadata":{},"sourceType":"module"}