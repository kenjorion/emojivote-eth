{"ast":null,"code":"import { useState, useEffect } from 'react';\nimport { ethers } from \"ethers\";\nimport { usePoller } from \".\";\nconst DEBUG = false;\nexport default function useCustomContractReader(contract, functionName, args, pollTime, formatter, onChange) {\n  let adjustPollTime = 3777;\n\n  if (pollTime) {\n    adjustPollTime = pollTime;\n  } else if (!pollTime && typeof args == \"number\") {\n    //it's okay to pass poll time as last argument without args for the call\n    adjustPollTime = args;\n  }\n\n  const [value, setValue] = useState();\n  useEffect(() => {\n    if (typeof onChange == \"function\") {\n      setTimeout(onChange.bind(this, value), 1);\n    }\n  }, [value]);\n  usePoller(async () => {\n    if (contract && typeof contract[functionName] != \"undefined\") {\n      try {\n        let newValue;\n        if (DEBUG) console.log(\"CALLING CUSTOM CONTRACT\", functionName, \"with args\", args);\n\n        if (args && args.length > 0) {\n          newValue = await contract[functionName](...args);\n          if (DEBUG) console.log(\"custom contract functionName\", functionName, \"args\", args, \"RESULT:\", newValue);\n        } else {\n          newValue = await contract[functionName]();\n        }\n\n        if (formatter && typeof formatter == \"function\") {\n          newValue = formatter(newValue);\n        } //console.log(\"GOT VALUE\",newValue)\n\n\n        if (newValue != value) {\n          setValue(newValue);\n        }\n      } catch (e) {\n        console.log(e);\n      }\n    }\n  }, adjustPollTime);\n  return value;\n}","map":{"version":3,"sources":["/Users/ken/Documents/scaffold-eth/packages/react-app/src/hooks/CustomContractReader.js"],"names":["useState","useEffect","ethers","usePoller","DEBUG","useCustomContractReader","contract","functionName","args","pollTime","formatter","onChange","adjustPollTime","value","setValue","setTimeout","bind","newValue","console","log","length","e"],"mappings":"AAAA,SAASA,QAAT,EAAmBC,SAAnB,QAAoC,OAApC;AACA,SAASC,MAAT,QAAuB,QAAvB;AACA,SAASC,SAAT,QAA0B,GAA1B;AAEA,MAAMC,KAAK,GAAG,KAAd;AAEA,eAAe,SAASC,uBAAT,CAAiCC,QAAjC,EAA0CC,YAA1C,EAAuDC,IAAvD,EAA4DC,QAA5D,EAAqEC,SAArE,EAA+EC,QAA/E,EAAyF;AAEtG,MAAIC,cAAc,GAAG,IAArB;;AACA,MAAGH,QAAH,EAAY;AACVG,IAAAA,cAAc,GAAGH,QAAjB;AACD,GAFD,MAEO,IAAG,CAACA,QAAD,IAAa,OAAOD,IAAP,IAAe,QAA/B,EAAwC;AAC7C;AACAI,IAAAA,cAAc,GAAGJ,IAAjB;AACD;;AAED,QAAM,CAACK,KAAD,EAAQC,QAAR,IAAoBd,QAAQ,EAAlC;AACAC,EAAAA,SAAS,CAAC,MAAM;AACd,QAAG,OAAOU,QAAP,IAAmB,UAAtB,EAAiC;AAC/BI,MAAAA,UAAU,CAACJ,QAAQ,CAACK,IAAT,CAAc,IAAd,EAAmBH,KAAnB,CAAD,EAA2B,CAA3B,CAAV;AACD;AACF,GAJQ,EAIN,CAACA,KAAD,CAJM,CAAT;AAMAV,EAAAA,SAAS,CAAC,YAAU;AAClB,QAAGG,QAAQ,IAAI,OAAOA,QAAQ,CAACC,YAAD,CAAf,IAAiC,WAAhD,EAA4D;AAC1D,UAAG;AACD,YAAIU,QAAJ;AACA,YAAGb,KAAH,EAAUc,OAAO,CAACC,GAAR,CAAY,yBAAZ,EAAsCZ,YAAtC,EAAoD,WAApD,EAAiEC,IAAjE;;AACV,YAAGA,IAAI,IAAEA,IAAI,CAACY,MAAL,GAAc,CAAvB,EAAyB;AACvBH,UAAAA,QAAQ,GAAG,MAAMX,QAAQ,CAACC,YAAD,CAAR,CAAuB,GAAGC,IAA1B,CAAjB;AACA,cAAGJ,KAAH,EAAUc,OAAO,CAACC,GAAR,CAAY,8BAAZ,EAA2CZ,YAA3C,EAAwD,MAAxD,EAA+DC,IAA/D,EAAoE,SAApE,EAA8ES,QAA9E;AACX,SAHD,MAGK;AACHA,UAAAA,QAAQ,GAAG,MAAMX,QAAQ,CAACC,YAAD,CAAR,EAAjB;AACD;;AACD,YAAGG,SAAS,IAAI,OAAOA,SAAP,IAAoB,UAApC,EAA+C;AAC7CO,UAAAA,QAAQ,GAAGP,SAAS,CAACO,QAAD,CAApB;AACD,SAXA,CAYD;;;AACA,YAAGA,QAAQ,IAAEJ,KAAb,EAAmB;AACjBC,UAAAA,QAAQ,CAACG,QAAD,CAAR;AACD;AACF,OAhBD,CAgBC,OAAMI,CAAN,EAAQ;AACPH,QAAAA,OAAO,CAACC,GAAR,CAAYE,CAAZ;AACD;AACF;AACF,GAtBQ,EAsBPT,cAtBO,CAAT;AAwBA,SAAOC,KAAP;AACD","sourcesContent":["import { useState, useEffect } from 'react';\nimport { ethers } from \"ethers\";\nimport { usePoller } from \".\";\n\nconst DEBUG = false\n\nexport default function useCustomContractReader(contract,functionName,args,pollTime,formatter,onChange) {\n\n  let adjustPollTime = 3777\n  if(pollTime){\n    adjustPollTime = pollTime\n  } else if(!pollTime && typeof args == \"number\"){\n    //it's okay to pass poll time as last argument without args for the call\n    adjustPollTime = args\n  }\n\n  const [value, setValue] = useState()\n  useEffect(() => {\n    if(typeof onChange == \"function\"){\n      setTimeout(onChange.bind(this,value),1)\n    }\n  }, [value]);\n\n  usePoller(async ()=>{\n    if(contract && typeof contract[functionName] != \"undefined\"){\n      try{\n        let newValue\n        if(DEBUG) console.log(\"CALLING CUSTOM CONTRACT\",functionName, \"with args\", args)\n        if(args&&args.length > 0){\n          newValue = await contract[functionName](...args)\n          if(DEBUG) console.log(\"custom contract functionName\",functionName,\"args\",args,\"RESULT:\",newValue)\n        }else{\n          newValue = await contract[functionName]()\n        }\n        if(formatter && typeof formatter == \"function\"){\n          newValue = formatter(newValue)\n        }\n        //console.log(\"GOT VALUE\",newValue)\n        if(newValue!=value){\n          setValue(newValue)\n        }\n      }catch(e){\n        console.log(e)\n      }\n    }\n  },adjustPollTime)\n\n  return value;\n}\n"]},"metadata":{},"sourceType":"module"}